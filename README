// $Id$

- 基本的な使い方
  lighttpdを、192.168.0.10:80で、echo serverを192.168.0.10:8000で起動
  し、browserからWeb Socket経由で繋げたいとします。

  この場合、まず何も考えずにecho serverを起動。

  次に、lighttpd.confに、
  websocket.server => ( "/echo" =>
                       ("host" => "192.168.0.10", "port" => 8000) )

  と、記述してあげた上でlighttpdを起動します。

  client側はjavascriptにて、

  var ws = new WebSocket("ws://192.168.0.10:80/echo");

  としてあげれば、echo serverまでつながります。Reverse Proxyとして動作
  するイメージですね。

  2010/02/15
  Hiroki Ohtani(@liris)さんところから、chat htmlいただきました。
  http://blog.liris.org/2009/12/websocketchat.html

  $ cat lighttpd.conf
  ...
  websocket.server = (
                      "/echo" => ( "host" => "127.0.0.1", "port" => 9000 ),
                      "/chat" => ( "host" => "127.0.0.1", "port" => 9001 )
                     )
  ...

  $ ./ws_chat 9001
  $ lighttpd -f /path_to/your_lighttpd.conf -m /path_to/your_modules

  こうした後で、Chromeなどからアクセスしていただくと、websocketを利用した
  chatが可能なはずです。

  http://your_machine_ip:your_lighttpd_port/ws_chat.html

- 現時点での注意点
  1. バックエンドのサーバのListen portには、現状Web Socketで規定されて
     いるframeがそのまま届きます。
     つまり、pywebsocketで言うところの、msgutilをちゃんと実装する必要
     があります。(先頭1byteと最終1byte、もしくはlength部分を処理する必
     要があります)
  2. allowed originを設定することが出来ません。セキュリティ上問題にな
     りますので、インターネット上で利用する場合にはご注意ください。
  3. Sub-Protocol、UTF-8についても全くhandleしていません。

- great thanks to
  Taiyo Fujii(@t_trace), Kensaku Komatsu(@komasshu),
  Toshiro Takahashi(@tohirot), Nobuyoshi Miyokawa(@nmiyo),
  Takezo(@velvetpass),
  and lighty developpers!

// EOF
